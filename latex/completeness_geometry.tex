\documentclass[12pt]{article}

% Language setting
% Replace `english' with e.g. `spanish' to change the document language
\usepackage[english]{babel}

% Set page size and margins
% Replace `letterpaper' with`a4paper' for UK/EU standard size
\usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

% Useful packages:
\usepackage{braket}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
%\usepackage{unicode-math}
\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{booktabs}
\usepackage{caption} 
\captionsetup[table]{skip=5pt}
\usepackage{calc}
\usepackage[section]{placeins}
%\usepackage{minted}
\usepackage{accents}
\usepackage{float}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
% set parameters:
\newcommand{\ubar}[1]{\underaccent{\bar}{#1}}
\newlength{\maxmin}
\setlength{\maxmin}{\widthof{$\max$}-\widthof{$\min$}}
\setcounter{tocdepth}{4}
\setcounter{secnumdepth}{4}

% macros:
\def\D{\displaystyle}
\def\att{                    % mark at the margin
        \marginpar[ \hspace*{\fill} \raisebox{-0.2em}{\rule{2mm}{1.2em}} ]
        {\raisebox{-0.2em}{\rule{2mm}{1.2em}} }
        }
\def\at#1{[*** \att #1 ***]}  % text needing attention
\def\spc{\hspace*{0.5cm}} 			% indentation


\begin{document}

\section{Completeness of molecular features}
Features of a molecular geometry (or configuration) is said to be complete if they describe distinct (numerical) values for each distinct molecular geometry; otherwise if the features of some distinct geometries result in equal numerical value, then the features are incomplete. One way to check the completeness is by conducting a quality test of the molecular features.

Consider the lattices
\begin{equation}
    \mathcal{L} = \sqrt{2}Z_3, D_3,
\end{equation}
they have a fixed set of distances
\begin{equation}
    \mathcal{D} := \{0, \sqrt{2}, \sqrt{4}, \sqrt{6}, \sqrt{8}, \sqrt{10}, ...\}.
\end{equation}
The coordinates of $\mathcal{L} = \sqrt{2}Z_3$ lattice are defined by
\begin{equation}
    x:= (\sqrt{2}x_1, \sqrt{2}x_2, \sqrt{2}x_3), \text{ where } x_i \in \mathbb{Z},
    \label{eq:completeness_Z_set}
\end{equation}
meanwhile the coordinates of $\mathcal{L} = D_3$ are defined by
\begin{equation}
    x:= (x_1, x_2, x_3), \text{ where } \sum_i x_i \text{ is even and } x_i \in \mathbb{Z}.
    \label{eq:completeness_D_set}
\end{equation}
Let
\begin{equation}
    S := \{x \mid \left\| x\right\|_2 < 3 \},
    \label{eq:completeness_distance_set}
\end{equation}
which implies the feasible set of distances
\begin{equation}
    \mathcal{D_F} := \{0, \sqrt{2}, \sqrt{4}, \sqrt{6}, \sqrt{8}\}.
\end{equation}
For all possible combinations of $x_i \in \mathbb{Z}$, if (\refeq{eq:completeness_Z_set}) and (\refeq{eq:completeness_D_set}) must satisfy (\refeq{eq:completeness_distance_set}), then we can define
\begin{equation}
    \begin{split}
        A:= \{ x \mid \left\| x \right\|_2^2 \leq 4\}, \\
        B:= \{ x \mid \left\| x \right\|_2^2 \leq 8\},
    \end{split}
    \label{eq:completeness_lattice_set}
\end{equation}
where the set $A$ corresponds to $\mathcal{L} = \sqrt{2}Z_3$, and $B$ corresponds to $\mathcal{L} = D_3$; this implies
\begin{equation}
    x_i \in \{0, \pm 1, \pm 2\}.
\end{equation}

The goal here is to find the "counterexamples" of the completeness, by using the features computed from $x_i$ data. 
The algorithm is as shown in Alg.(\refeq{alg:completeness_check}). In this case, $N$ corresponds to the number of atoms in the molecule, where $N > 3$ is of interest.


\begin{algorithm}
    \caption{Completeness check}
    \label{alg:completeness_check}
    \begin{algorithmic}[1] 
        \For{each $\mathcal{L}$ and each size $N$}
            \State Let $\Gamma$ be an empty storage.
            \State Pick random subset $T \in \mathbb{R}^{N \times 3} \subset S$, 
            and scale $T$ such that the smallest distance is the pair-potential equilibrium distance $r_\text{eq}$.
            \State Compute the feature vector $v$ from $T$.
            \If{$\Gamma \neq \emptyset$}
                \State compare $(T,v)$ with $(T_i, v_i) \in \Gamma, i = 1,2,...,|\Gamma|$, 
                for each pairing comparison: 
                \If{the feature vector $v \equiv v_i$} 
                    \State check for the isomorphism of $T$ and $T_i$:
                    \If{not isomorphic}
                        \State mark $(T, v)$ as an counterexample,
                    \ElsIf{isomorphic} 
                        \State skip $i$.
                    \EndIf
                \EndIf
            \EndIf
            \State Append $(T,v)$ to $\Gamma$.
            \State Repeat until no new possible entries to be added. 
        \EndFor
    \end{algorithmic}
\end{algorithm}



\end{document}



    
